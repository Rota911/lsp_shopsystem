InShopMarker=nil;ShopActive=false;local a=false;function OpenShop(b)if b then SetNuiFocus(true,true)SendNUIMessage({action='OPEN',items=b.items})a=false;ShopActive=true end end;function CloseShop()SetNuiFocus(false,false)SendNUIMessage({action='CLOSE'})a=false;ShopActive=false end;Citizen.CreateThread(function()while true do if IsControlJustPressed(0,38)and not ShopActive and InShopMarker then if a then ESX.ShowNotification(Config.labels.wait)return end;a=true;ESX.TriggerServerCallback('sShops:openShop',OpenShop,InShopMarker)end;Wait(1)end end)Citizen.CreateThread(function()for c,b in ipairs(Config.shops)do if b.blip and b.blip.enabled then local d=ESX.GetPlayerData()if b.groups and not b.groups[d.job.name]then goto e end;local f=b.position;local g=AddBlipForCoord(f.x,f.y,f.z)SetBlipSprite(g,b.blip.id)SetBlipDisplay(g,4)SetBlipScale(g,1.0)SetBlipColour(g,b.blip.color)SetBlipAsShortRange(g,true)BeginTextCommandSetBlipName("STRING")AddTextComponentString(b.name)EndTextCommandSetBlipName(g)::e::end end end)RegisterNUICallback('purchase',function(h)CloseShop()ESX.TriggerServerCallback('sShops:purchase',function()end,InShopMarker,h.items)end)RegisterNUICallback('close',function()CloseShop()end)